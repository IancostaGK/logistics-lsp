<div class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-[1fr_300px] gap-6 items-start">

    <!-- Left column: main content -->
    <div>

      <!-- Header -->
      <div class="mb-8">
        <div class="flex items-start gap-4 mb-5">
          <div class="scenario-num scenario-num-green">02</div>
          <div class="pt-2">
            <div class="flex items-center gap-3 mb-2 flex-wrap">
              <h1 class="text-3xl font-black t-hi">Scenario 2</h1>
              <span class="badge badge-green">✓ LSP COMPLIANT</span>
            </div>
            <p class="text-base font-medium t-dim">Good: Segregated Interfaces with Type Guards</p>
          </div>
        </div>

        <div class="desc-box desc-box-green">
          <strong class="t-green">Solution:</strong> We no longer force
          <code class="chip chip-green ml-1">ElectricScooter</code>
          to implement an incompatible method.
          <code class="chip chip-green">EngineVehicle</code>
          and
          <code class="chip chip-green">ElectricVehicle</code>
          extend a shared
          <code class="chip chip-green">Vehicle</code>
          base — type guards dispatch the right action for each type.
          <strong class="t-green-hi">No crashes possible.</strong>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-3 mb-8 flex-wrap">
        <button (click)="dispatchAll()" class="btn btn-green">
          ✅ Dispatch All
          <span class="text-xs" style="color: rgba(110,231,183,0.5);">(no crash)</span>
        </button>
        <button (click)="reset()" class="btn btn-ghost">↺ Reset</button>
      </div>

      <!-- Cards Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
        @for (card of cards; track card.vehicle.id) {
          <div
            class="rounded-2xl overflow-hidden transition-all duration-300"
            [style.background]="'var(--bg-surface)'"
            [style.border]="card.result ? '1px solid rgba(16,185,129,0.45)' : '1px solid var(--border)'"
          >
            <!-- Card Header -->
            <div class="p-5 pb-4 card-sep">
              <div class="text-4xl mb-3 select-none">{{ card.vehicle.icon }}</div>
              <h3 class="font-bold text-base mb-2 t-base">{{ card.vehicle.name }}</h3>
              <!-- Type Badge -->
              <span
                class="inline-flex items-center text-xs font-semibold px-2.5 py-1 rounded-full"
                [style.background]="isEngineVehicle(card.vehicle) ? 'rgba(59,130,246,0.1)' : 'rgba(16,185,129,0.1)'"
                [style.border]="isEngineVehicle(card.vehicle) ? '1px solid rgba(59,130,246,0.3)' : '1px solid rgba(16,185,129,0.3)'"
                [style.color]="isEngineVehicle(card.vehicle) ? '#93C5FD' : '#6EE7B7'"
              >
                {{ getVehicleTypeBadge(card.vehicle) }}
              </span>
            </div>

            <!-- Card Body -->
            <div class="p-5">
              <!-- Status Area -->
              <div
                class="min-h-14 mb-4 text-sm rounded-xl p-3.5 transition-all duration-300"
                [style.background]="card.result ? 'rgba(16,185,129,0.07)' : 'var(--bg-raised)'"
                [style.border]="card.result ? '1px solid rgba(16,185,129,0.2)' : '1px solid var(--border)'"
              >
                @if (card.result) {
                  <p class="font-medium t-green">✅ {{ card.result }}</p>
                } @else {
                  <p class="italic text-xs t-ghost">Press Dispatch to trigger the correct action</p>
                }
              </div>

              <!-- Dispatch Button -->
              <button (click)="dispatch(card)" class="btn-dispatch btn-dispatch-green">
                {{ getActionLabel(card.vehicle) }}
              </button>
            </div>
          </div>
        }
      </div>

      <!-- Code Block -->
      <div class="code-block">
        <!-- Terminal Chrome -->
        <div class="terminal-chrome">
          <span class="w-3 h-3 rounded-full inline-block" style="background: rgba(239,68,68,0.7);"></span>
          <span class="w-3 h-3 rounded-full inline-block" style="background: rgba(245,158,11,0.7);"></span>
          <span class="w-3 h-3 rounded-full inline-block" style="background: rgba(16,185,129,0.7);"></span>
          <span class="ml-3 text-xs t-ghost mono">vehicle.interfaces.ts — The Solution</span>
        </div>
        <div class="p-6 overflow-x-auto">
          <pre class="text-sm leading-relaxed mono t-muted"><span class="t-dim">// Shared base — only common fields</span>
<span class="t-blue">interface</span> <span class="t-green">Vehicle</span> &#123; id: <span style="color: #67E8F9;">number</span>; name: <span style="color: #67E8F9;">string</span>; icon: <span style="color: #67E8F9;">string</span>; &#125;

<span class="t-dim">// ✅ Only for vehicles that have engines</span>
<span class="t-blue">interface</span> <span class="t-green">EngineVehicle</span> <span class="t-blue">extends</span> Vehicle &#123;
  <span style="color: #FDE68A;">startEngine</span>(): <span style="color: #67E8F9;">string</span>;
&#125;

<span class="t-dim">// ✅ Only for electric vehicles</span>
<span class="t-blue">interface</span> <span class="t-green">ElectricVehicle</span> <span class="t-blue">extends</span> Vehicle &#123;
  <span style="color: #FDE68A;">chargeBattery</span>(): <span style="color: #67E8F9;">string</span>;
&#125;

<span class="t-dim">// Type guards — safe dispatch, no try/catch needed</span>
<span class="t-blue">if</span> (<span style="color: #FDE68A;">isEngineVehicle</span>(v))   v.<span style="color: #FDE68A;">startEngine</span>();   <span class="t-green">// ✅ safe</span>
<span class="t-blue">if</span> (<span style="color: #FDE68A;">isElectricVehicle</span>(v)) v.<span style="color: #FDE68A;">chargeBattery</span>(); <span class="t-green">// ✅ safe</span></pre>
        </div>
      </div>

    </div>

    <!-- Right column: discussion sidebar -->
    <app-discussion-sidebar
      routeKey="good"
      [questions]="[
        'Why can\'t the scooter safely substitute the base class?',
        'What design assumption was flawed from the beginning?',
        'How does this affect scalability?',
        'What are the typical organizational gaps that lead to this?'
      ]"
    ></app-discussion-sidebar>

  </div>
</div>
