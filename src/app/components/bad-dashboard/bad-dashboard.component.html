<div class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-[1fr_300px] gap-6 items-start">

    <!-- Left column: main content -->
    <div>

      <!-- Header -->
      <div class="mb-8">
        <div class="flex items-start gap-4 mb-5">
          <div class="scenario-num scenario-num-red">01</div>
          <div class="pt-2">
            <div class="flex items-center gap-3 mb-2 flex-wrap">
              <h1 class="text-3xl font-black t-hi">Scenario 1</h1>
              <span class="badge badge-red">‚úï LSP VIOLATION</span>
            </div>
            <p class="text-base font-medium t-dim">Bad: Abstract Class with Incompatible Override</p>
          </div>
        </div>

        <div class="desc-box desc-box-red">
          <strong class="t-red">Problem:</strong>
          <code class="chip chip-red ml-1">ElectricScooter</code>
          extends
          <code class="chip chip-red">VehicleBase</code>
          but <strong class="t-red-hi">throws an error</strong> inside
          <code class="chip chip-red">startEngine()</code>
          ‚Äî violating LSP. Any code that iterates vehicles and calls
          <code class="chip chip-red">startEngine()</code>
          will crash at runtime. Press <strong class="t-red-hi">Dispatch All</strong> to see it happen.
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-3 mb-8 flex-wrap">
        <button (click)="dispatchAll()" class="btn btn-red">
          üí• Dispatch All
          <span class="text-xs" style="color: rgba(252,165,165,0.5);">(triggers crash)</span>
        </button>
        <button (click)="reset()" class="btn btn-ghost">‚Ü∫ Reset</button>
      </div>

      <!-- Cards Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-10">
        @for (card of cards; track card.vehicle.id) {
          <div
            class="rounded-2xl overflow-hidden transition-all duration-300"
            [style.background]="'var(--bg-surface)'"
            [style.border]="card.error ? '1px solid rgba(239,68,68,0.5)' : card.result ? '1px solid rgba(16,185,129,0.4)' : '1px solid var(--border)'"
          >
            <!-- Card Header -->
            <div class="p-5 pb-4 card-sep">
              <div class="text-4xl mb-3 select-none">{{ card.vehicle.icon }}</div>
              <h3 class="font-bold text-base mb-0.5 t-base">{{ card.vehicle.name }}</h3>
              <span class="text-xs block t-ghost mono">{{ card.vehicle.constructor.name }}</span>
            </div>

            <!-- Card Body -->
            <div class="p-5">
              <!-- Status Area -->
              <div
                class="min-h-14 mb-4 text-sm rounded-xl p-3.5 transition-all duration-300"
                [style.background]="card.error ? 'rgba(239,68,68,0.07)' : card.result ? 'rgba(16,185,129,0.07)' : 'var(--bg-raised)'"
                [style.border]="card.error ? '1px solid rgba(239,68,68,0.2)' : card.result ? '1px solid rgba(16,185,129,0.2)' : '1px solid var(--border)'"
              >
                @if (card.result) {
                  <p class="font-medium t-green">‚úÖ {{ card.result }}</p>
                } @else if (card.error) {
                  <p class="font-medium t-red">
                    üí• <span class="font-bold">Error:</span> {{ card.error }}
                  </p>
                } @else {
                  <p class="italic text-xs t-ghost">Press Dispatch to call startEngine()</p>
                }
              </div>

              <!-- Dispatch Button -->
              <button (click)="dispatch(card)" class="btn-dispatch btn-dispatch-red">
                üöÄ Dispatch
              </button>
            </div>
          </div>
        }
      </div>

      <!-- Code Block -->
      <div class="code-block">
        <!-- Terminal Chrome -->
        <div class="terminal-chrome">
          <span class="w-3 h-3 rounded-full inline-block" style="background: rgba(239,68,68,0.7);"></span>
          <span class="w-3 h-3 rounded-full inline-block" style="background: rgba(245,158,11,0.7);"></span>
          <span class="w-3 h-3 rounded-full inline-block" style="background: rgba(16,185,129,0.7);"></span>
          <span class="ml-3 text-xs t-ghost mono">vehicle-base.ts ‚Äî The Violation</span>
        </div>
        <div class="p-6 overflow-x-auto">
          <pre class="text-sm leading-relaxed mono t-muted"><span class="t-blue">abstract class</span> <span class="t-green">VehicleBase</span> &#123;
  <span class="t-blue">abstract</span> <span style="color: #FDE68A;">startEngine</span>(): <span style="color: #67E8F9;">string</span>;
&#125;

<span class="t-dim">// ‚úÖ Works fine ‚Äî honours the contract</span>
<span class="t-blue">class</span> <span class="t-green">Truck</span> <span class="t-blue">extends</span> VehicleBase &#123;
  <span style="color: #FDE68A;">startEngine</span>() &#123; <span class="t-blue">return</span> <span style="color: #FDBA74;">"V8 roaring!"</span>; &#125;
&#125;

<span class="t-dim">// ‚ùå LSP VIOLATION ‚Äî throws instead of returning string</span>
<span class="t-blue">class</span> <span class="t-red">ElectricScooter</span> <span class="t-blue">extends</span> VehicleBase &#123;
  <span style="color: #FDE68A;">startEngine</span>() &#123; <span class="t-blue">throw new</span> <span class="t-red">Error</span>(<span style="color: #FDBA74;">"No engine!"</span>); &#125;
&#125;

<span class="t-dim">// Iterating all vehicles: will crash on ElectricScooter</span>
vehicles.<span style="color: #FDE68A;">forEach</span>(v <span class="t-blue">=&gt;</span> v.<span style="color: #FDE68A;">startEngine</span>()); <span class="t-red">// üí• BOOM</span></pre>
        </div>
      </div>

    </div>

    <!-- Right column: discussion sidebar -->
    <app-discussion-sidebar
      routeKey="bad"
      [questions]="[
        'Why can\'t the scooter safely substitute the base class?',
        'What design assumption was flawed from the beginning?',
        'How does this affect scalability?',
        'What are the typical organizational gaps that lead to this?'
      ]"
    ></app-discussion-sidebar>

  </div>
</div>
