<div class="max-w-7xl mx-auto px-4 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-[1fr_300px] gap-6 items-start">

    <!-- Left column: main content -->
    <div>

      <!-- Header -->
      <div class="mb-8">
        <div class="flex items-center gap-3 mb-2">
          <h1 class="text-3xl font-bold text-gray-900">Scenario 1</h1>
          <span class="bg-red-100 text-red-700 text-sm font-semibold px-3 py-1 rounded-full border border-red-200">
            ‚ùå LSP Violation
          </span>
        </div>
        <p class="text-lg text-gray-500 mb-4">Bad: Abstract Class with Incompatible Override</p>
        <div class="bg-red-50 border border-red-200 rounded-xl p-4 text-sm text-red-800 leading-relaxed">
          <strong>Problem:</strong>
          <code class="bg-red-100 px-1 rounded">ElectricScooter</code> extends
          <code class="bg-red-100 px-1 rounded">VehicleBase</code> but
          <strong>throws an error</strong> inside
          <code class="bg-red-100 px-1 rounded">startEngine()</code> ‚Äî violating LSP.
          Any code that iterates vehicles and calls <code class="bg-red-100 px-1 rounded">startEngine()</code>
          will crash at runtime. Press <strong>Dispatch All</strong> to see it happen.
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex gap-3 mb-6">
        <button
          (click)="dispatchAll()"
          class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-5 rounded-lg transition-colors text-sm">
          üí• Dispatch All (triggers crash)
        </button>
        <button
          (click)="reset()"
          class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg transition-colors text-sm">
          ‚Ü∫ Reset
        </button>
      </div>

      <!-- Cards Grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10">
        @for (card of cards; track card.vehicle.id) {
          <div
            class="bg-white rounded-xl shadow-md border-2 overflow-hidden transition-colors"
            [class.border-green-300]="card.result"
            [class.border-red-400]="card.error"
            [class.border-gray-100]="!card.result && !card.error"
          >
            <!-- Card Header -->
            <div class="p-6 border-b border-gray-50">
              <div class="text-5xl mb-3 select-none">{{ card.vehicle.icon }}</div>
              <h3 class="text-lg font-bold text-gray-900">{{ card.vehicle.name }}</h3>
              <span class="text-xs text-slate-400 font-mono">{{ card.vehicle.constructor.name }}</span>
            </div>

            <!-- Card Body -->
            <div class="p-6">
              <!-- Result / Error Area -->
              <div
                class="min-h-14 mb-4 text-sm rounded-lg p-3 transition-colors"
                [class.bg-gray-50]="!card.result && !card.error"
                [class.bg-green-50]="!!card.result"
                [class.bg-red-50]="!!card.error"
              >
                @if (card.result) {
                  <p class="text-green-700 font-medium">‚úÖ {{ card.result }}</p>
                } @else if (card.error) {
                  <p class="text-red-700 font-medium">
                    üí• <span class="font-bold">Error:</span> {{ card.error }}
                  </p>
                } @else {
                  <p class="text-gray-400 italic text-xs">Press Dispatch to call startEngine()</p>
                }
              </div>

              <!-- Dispatch Button -->
              <button
                (click)="dispatch(card)"
                class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors text-sm">
                üöÄ Dispatch
              </button>
            </div>
          </div>
        }
      </div>

      <!-- Code Snippet -->
      <div class="bg-gray-900 rounded-xl p-6 overflow-x-auto">
        <p class="text-amber-400 font-semibold text-base mb-4 font-sans">üìÑ The Violation</p>
        <pre class="text-sm font-mono leading-relaxed text-gray-300"><span class="text-blue-400">abstract class</span> <span class="text-green-400">VehicleBase</span> &#123;
  <span class="text-blue-400">abstract</span> <span class="text-yellow-300">startEngine</span>(): <span class="text-cyan-400">string</span>;
&#125;

<span class="text-gray-500">// ‚úÖ Works fine ‚Äî honours the contract</span>
<span class="text-blue-400">class</span> <span class="text-green-400">Truck</span> <span class="text-blue-400">extends</span> VehicleBase &#123;
  <span class="text-yellow-300">startEngine</span>() &#123; <span class="text-blue-400">return</span> <span class="text-orange-300">"V8 roaring!"</span>; &#125;
&#125;

<span class="text-gray-500">// ‚ùå LSP VIOLATION ‚Äî throws instead of returning string</span>
<span class="text-blue-400">class</span> <span class="text-red-400">ElectricScooter</span> <span class="text-blue-400">extends</span> VehicleBase &#123;
  <span class="text-yellow-300">startEngine</span>() &#123; <span class="text-blue-400">throw new</span> <span class="text-red-400">Error</span>(<span class="text-orange-300">"No engine!"</span>); &#125;
&#125;

<span class="text-gray-500">// Iterating all vehicles: will crash on ElectricScooter</span>
vehicles.<span class="text-yellow-300">forEach</span>(v <span class="text-blue-400">=></span> v.<span class="text-yellow-300">startEngine</span>()); <span class="text-red-400">// üí• BOOM</span></pre>
      </div>

    </div>

    <!-- Right column: discussion sidebar -->
    <app-discussion-sidebar
      routeKey="bad"
      [questions]="[
        'Why can\'t the scooter safely substitute the base class?',
        'What design assumption was flawed from the beginning?',
        'How does this affect scalability?',
        'What are the typical organizational gaps that lead to this?'
      ]"
    ></app-discussion-sidebar>

  </div>
</div>
