<div class="max-w-7xl mx-auto px-4 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-[1fr_300px] gap-6 items-start">

    <!-- Left column: main content -->
    <div>

      <!-- Header -->
      <div class="mb-8">
        <div class="flex items-center gap-3 mb-2">
          <h1 class="text-3xl font-bold text-gray-900">Scenario 3</h1>
          <span class="bg-amber-100 text-amber-700 text-sm font-semibold px-3 py-1 rounded-full border border-amber-200">
            ‚ö†Ô∏è Overengineered
          </span>
        </div>
        <p class="text-lg text-gray-500 mb-4">Bad: One Separate Interface per Vehicle (Duplication)</p>
        <div class="bg-amber-50 border border-amber-200 rounded-xl p-4 text-sm text-amber-800 leading-relaxed">
          <strong>Problem:</strong> Each vehicle type gets its own interface ‚Äî
          <code class="bg-amber-100 px-1 rounded">ITruck</code>,
          <code class="bg-amber-100 px-1 rounded">IMotorcycle</code>,
          <code class="bg-amber-100 px-1 rounded">IElectricScooter</code> ‚Äî each with the <strong>same 5 fields
          duplicated</strong>. This is a different kind of poor design: it violates DRY and explodes
          maintenance cost. Use the simulator below to feel the pain.
        </div>
      </div>

      <!-- Maintenance Cost Counter -->
      <div class="bg-gradient-to-r from-red-600 to-red-700 text-white rounded-xl p-6 mb-8 flex items-center justify-between shadow-lg">
        <div>
          <p class="text-sm font-medium text-red-200 uppercase tracking-wide mb-1">Maintenance Cost</p>
          <p class="text-2xl font-bold leading-tight">
            To add <span class="underline decoration-red-300">1 field</span>, you must edit
          </p>
          <p class="text-red-200 text-sm mt-1">Try the simulator below to experience it ‚Üì</p>
        </div>
        <div class="text-right ml-6">
          <span class="text-8xl font-black leading-none">{{ interfaceCount }}</span>
          <p class="text-red-200 font-semibold text-lg">interfaces</p>
        </div>
      </div>

      <!-- Side-by-Side Comparison -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">

        <!-- ‚ùå Overengineered -->
        <div class="bg-white rounded-xl shadow-md border-2 border-red-200 overflow-hidden">
          <div class="bg-red-50 px-5 py-4 border-b border-red-200">
            <h3 class="font-bold text-red-800 text-base">‚ùå Overengineered (current)</h3>
            <p class="text-sm text-red-600 mt-1">
              {{ interfaceCount }} interfaces √ó 6 fields = <strong>18 declarations</strong>
            </p>
          </div>
          <div class="p-5 font-mono text-xs space-y-3">
            @for (iface of overengineeredInterfaces; track iface.name) {
              <div
                class="border rounded-lg p-3 transition-all duration-300"
                [class.border-red-300]="!highlightAll"
                [class.bg-red-50]="!highlightAll"
                [class.border-red-500]="highlightAll"
                [class.bg-red-100]="highlightAll"
                [class.ring-2]="highlightAll"
                [class.ring-red-400]="highlightAll"
              >
                <div>
                  <span class="text-purple-600 font-bold">interface </span>
                  <span class="text-blue-700 font-bold">{{ iface.name }}</span>
                  <span class="text-gray-600"> &#123;</span>
                </div>
                <div class="pl-3 mt-1 space-y-0.5">
                  @for (field of iface.fields; track field) {
                    <div
                      class="rounded px-1 transition-colors duration-200"
                      [class.bg-yellow-200]="field === newFieldLabel && highlightAll"
                      [class.text-yellow-900]="field === newFieldLabel && highlightAll"
                    >
                      <span class="text-gray-500">  {{ field }};</span>
                    </div>
                  }
                </div>
                <span class="text-gray-600">&#125;</span>
              </div>
            }
          </div>
        </div>

        <!-- ‚úÖ Good Approach -->
        <div class="bg-white rounded-xl shadow-md border-2 border-green-200 overflow-hidden">
          <div class="bg-green-50 px-5 py-4 border-b border-green-200">
            <h3 class="font-bold text-green-800 text-base">‚úÖ Good Approach</h3>
            <p class="text-sm text-green-600 mt-1">
              1 shared base + 3 specific interfaces = <strong>7 declarations</strong>
            </p>
          </div>
          <div class="p-5 font-mono text-xs space-y-3">
            <!-- Shared Base -->
            <div class="border border-green-300 bg-green-50 rounded-lg p-3">
              <span class="text-purple-600 font-bold">interface </span>
              <span class="text-green-700 font-bold">Vehicle</span>
              <span class="text-gray-600"> &#123;</span>
              <div class="pl-3 mt-1 space-y-0.5">
                <div><span class="text-gray-500">  id: number;</span></div>
                <div><span class="text-gray-500">  name: string;</span></div>
                <div
                  class="rounded px-1 transition-colors duration-200"
                  [class.bg-yellow-200]="highlightAll"
                  [class.text-yellow-900]="highlightAll"
                >
                  @if (highlightAll) {
                    <span class="text-yellow-800 font-bold">  weight: number; </span>
                    <span class="text-green-600 font-sans font-bold">‚Üê edit once ‚úÖ</span>
                  } @else {
                    <span class="text-gray-500">  icon: string;</span>
                  }
                </div>
              </div>
              <span class="text-gray-600">&#125;</span>
            </div>

            <!-- Specific Interfaces -->
            <div class="pl-4 space-y-2 relative">
              <div class="absolute left-0 top-2 bottom-2 w-0.5 bg-gray-300 rounded"></div>
              @for (iface of goodInterfaces; track iface.name) {
                <div class="border border-blue-200 bg-blue-50 rounded-lg p-3 relative">
                  <div class="absolute -left-4 top-1/2 -translate-y-1/2 w-4 h-0.5 bg-gray-300"></div>
                  <span class="text-purple-600 font-bold">interface </span>
                  <span class="text-blue-700 font-bold">{{ iface.name }}</span>
                  <span class="text-gray-400 font-sans text-xs"> extends Vehicle</span>
                  <span class="text-gray-600"> &#123; {{ iface.extra }}; &#125;</span>
                </div>
              }
            </div>
          </div>
        </div>

      </div>

      <!-- Field Simulator -->
      <div class="bg-slate-900 rounded-xl p-6 mb-10">
        <h3 class="text-white font-bold text-base mb-1">üî¨ Field Addition Simulator</h3>
        <p class="text-slate-400 text-sm mb-4">
          Click below to simulate adding <code class="text-orange-300 bg-slate-800 px-1 rounded">weight: number</code>
          to all vehicle types and see the cost difference:
        </p>
        @if (!highlightAll) {
          <button
            (click)="simulateAddField()"
            class="bg-amber-500 hover:bg-amber-600 text-white font-semibold py-2 px-6 rounded-lg transition-colors text-sm">
            ‚ûï Add field: weight: number
          </button>
        } @else {
          <div class="flex items-center gap-4 flex-wrap">
            <span class="bg-red-900 text-red-300 font-semibold py-2 px-4 rounded-lg text-sm">
              ‚ùå Overengineered: edited {{ interfaceCount }} interfaces
            </span>
            <span class="bg-green-900 text-green-300 font-semibold py-2 px-4 rounded-lg text-sm">
              ‚úÖ Good approach: edited 1 interface
            </span>
            <button
              (click)="resetSimulation()"
              class="text-slate-400 hover:text-white text-sm underline transition-colors">
              ‚Ü∫ Reset simulation
            </button>
          </div>
        }
      </div>

      <!-- Vehicle Cards -->
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-bold text-gray-900">Fleet</h2>
        <button
          (click)="dispatchAll()"
          class="bg-amber-600 hover:bg-amber-700 text-white font-semibold py-2 px-5 rounded-lg transition-colors text-sm">
          üöÄ Dispatch All
        </button>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        @for (card of vehicleCards; track card.vehicle.id) {
          <div
            class="bg-white rounded-xl shadow-md border-2 overflow-hidden transition-colors"
            [class.border-amber-300]="card.result"
            [class.border-gray-100]="!card.result"
          >
            <!-- Card Header -->
            <div class="p-6 border-b border-gray-50">
              <div class="text-5xl mb-3 select-none">{{ card.icon }}</div>
              <h3 class="text-lg font-bold text-gray-900">{{ card.vehicle.name }}</h3>
              <div class="flex gap-2 mt-2 flex-wrap">
                <span class="bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded font-mono">
                  {{ card.vehicle.color }}
                </span>
                <span class="bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded font-mono">
                  {{ card.vehicle.maxSpeed }} km/h
                </span>
                <span class="bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded font-mono">
                  {{ card.vehicle.payload }} kg
                </span>
              </div>
            </div>

            <!-- Card Body -->
            <div class="p-6">
              <div
                class="min-h-14 mb-4 text-sm rounded-lg p-3 transition-colors"
                [class.bg-gray-50]="!card.result"
                [class.bg-amber-50]="!!card.result"
              >
                @if (card.result) {
                  <p class="text-amber-800 font-medium">üöÄ {{ card.result }}</p>
                } @else {
                  <p class="text-gray-400 italic text-xs">Press Dispatch</p>
                }
              </div>
              <button
                (click)="dispatch(card)"
                class="w-full bg-amber-600 hover:bg-amber-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors text-sm">
                üöÄ Dispatch
              </button>
            </div>
          </div>
        }
      </div>

    </div>

    <!-- Right column: discussion sidebar -->
    <app-discussion-sidebar
      routeKey="overengineered"
      [questions]="[
        'When does \'following the principle\' become the problem?',
        'How many interfaces is too many?',
        'What\'s the cost of over-abstraction on a real team?'
      ]"
    ></app-discussion-sidebar>

  </div>
</div>
