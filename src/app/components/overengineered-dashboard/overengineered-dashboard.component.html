<div class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-[1fr_300px] gap-6 items-start">

    <!-- Left column: main content -->
    <div>

      <!-- Header -->
      <div class="mb-8">
        <div class="flex items-start gap-4 mb-5">
          <div class="font-black text-[5rem] leading-none select-none shrink-0" style="color: #1E1800; font-family: 'Syne', sans-serif;">03</div>
          <div class="pt-2">
            <div class="flex items-center gap-3 mb-2 flex-wrap">
              <h1 class="text-3xl font-black" style="color: #F1F5F9;">Scenario 3</h1>
              <span class="inline-flex items-center gap-1.5 text-xs font-bold px-3 py-1.5 rounded-full"
                    style="background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.3); color: #FCD34D; font-family: 'JetBrains Mono', monospace;">
                ‚ö† OVERENGINEERED
              </span>
            </div>
            <p class="text-base font-medium" style="color: #64748B;">Bad: One Separate Interface per Vehicle (Duplication)</p>
          </div>
        </div>

        <div class="rounded-xl p-5 text-sm leading-relaxed"
             style="background: rgba(245,158,11,0.05); border: 1px solid rgba(245,158,11,0.2); color: rgba(252,211,77,0.75);">
          <strong style="color: #FCD34D;">Problem:</strong> Each vehicle type gets its own interface ‚Äî
          <code class="px-1.5 py-0.5 rounded text-xs ml-1" style="background: rgba(245,158,11,0.15); color: #FCD34D;">ITruck</code>,
          <code class="px-1.5 py-0.5 rounded text-xs" style="background: rgba(245,158,11,0.15); color: #FCD34D;">IMotorcycle</code>,
          <code class="px-1.5 py-0.5 rounded text-xs" style="background: rgba(245,158,11,0.15); color: #FCD34D;">IElectricScooter</code>
          ‚Äî each with the <strong style="color: #FCD34D;">same 5 fields duplicated</strong>. This is a different kind of poor design:
          it violates DRY and explodes maintenance cost. Use the simulator below to feel the pain.
        </div>
      </div>

      <!-- Maintenance Cost Counter -->
      <div class="rounded-2xl p-6 mb-8 flex items-center justify-between gap-4"
           style="background: linear-gradient(135deg, rgba(239,68,68,0.15), rgba(220,38,38,0.1)); border: 1px solid rgba(239,68,68,0.3);">
        <div class="flex-1">
          <p class="text-xs font-mono uppercase tracking-widest mb-2" style="color: rgba(252,165,165,0.6);">Maintenance Cost</p>
          <p class="text-xl font-bold leading-tight" style="color: #FCA5A5;">
            To add <span class="underline decoration-red-400">1 field</span>, you must edit
          </p>
          <p class="text-sm mt-1" style="color: rgba(252,165,165,0.5);">Try the simulator below to experience it ‚Üì</p>
        </div>
        <div class="text-right shrink-0">
          <span class="font-black leading-none block" style="font-size: 5rem; color: #F87171; line-height: 1; font-family: 'Syne', sans-serif;">{{ interfaceCount }}</span>
          <p class="font-semibold text-lg" style="color: rgba(248,113,113,0.6);">interfaces</p>
        </div>
      </div>

      <!-- Side-by-Side Comparison -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-5 mb-8">

        <!-- Overengineered -->
        <div class="rounded-2xl overflow-hidden"
             style="background: var(--bg-surface); border: 1px solid rgba(239,68,68,0.25);">
          <div class="px-5 py-4" style="background: rgba(239,68,68,0.08); border-bottom: 1px solid rgba(239,68,68,0.2);">
            <h3 class="font-bold text-sm" style="color: #F87171;">‚ùå Overengineered (current)</h3>
            <p class="text-xs mt-1" style="color: rgba(248,113,113,0.6);">
              {{ interfaceCount }} interfaces √ó 6 fields = <strong style="color: #F87171;">18 declarations</strong>
            </p>
          </div>
          <div class="p-4 space-y-2.5">
            @for (iface of overengineeredInterfaces; track iface.name) {
              <div
                class="rounded-xl p-3 transition-all duration-300"
                [style.background]="highlightAll ? 'rgba(239,68,68,0.1)' : 'var(--bg-raised)'"
                [style.border]="highlightAll ? '1px solid rgba(239,68,68,0.4)' : '1px solid var(--border)'"
                [style.box-shadow]="highlightAll ? '0 0 0 2px rgba(239,68,68,0.1)' : 'none'"
              >
                <div class="text-xs" style="font-family: 'JetBrains Mono', monospace;">
                  <span style="color: #C084FC;">interface </span>
                  <span style="color: #60A5FA; font-weight: bold;">{{ iface.name }}</span>
                  <span style="color: #94A3B8;"> &#123;</span>
                  <div class="pl-4 mt-1 space-y-0.5">
                    @for (field of iface.fields; track field) {
                      <div
                        class="rounded px-1 transition-all duration-200"
                        [style.background]="field === newFieldLabel && highlightAll ? 'rgba(252,211,77,0.15)' : 'transparent'"
                      >
                        <span [style.color]="field === newFieldLabel && highlightAll ? '#FCD34D' : '#64748B'">  {{ field }};</span>
                      </div>
                    }
                  </div>
                  <span style="color: #94A3B8;">&#125;</span>
                </div>
              </div>
            }
          </div>
        </div>

        <!-- Good Approach -->
        <div class="rounded-2xl overflow-hidden"
             style="background: var(--bg-surface); border: 1px solid rgba(16,185,129,0.25);">
          <div class="px-5 py-4" style="background: rgba(16,185,129,0.08); border-bottom: 1px solid rgba(16,185,129,0.2);">
            <h3 class="font-bold text-sm" style="color: #34D399;">‚úÖ Good Approach</h3>
            <p class="text-xs mt-1" style="color: rgba(52,211,153,0.6);">
              1 shared base + 3 specific interfaces = <strong style="color: #34D399;">7 declarations</strong>
            </p>
          </div>
          <div class="p-4 space-y-2.5">
            <!-- Shared Base -->
            <div class="rounded-xl p-3" style="background: rgba(16,185,129,0.06); border: 1px solid rgba(16,185,129,0.2);">
              <div class="text-xs" style="font-family: 'JetBrains Mono', monospace;">
                <span style="color: #C084FC;">interface </span>
                <span style="color: #34D399; font-weight: bold;">Vehicle</span>
                <span style="color: #94A3B8;"> &#123;</span>
                <div class="pl-4 mt-1 space-y-0.5">
                  <div><span style="color: #64748B;">  id: number;</span></div>
                  <div><span style="color: #64748B;">  name: string;</span></div>
                  <div
                    class="rounded px-1 transition-all duration-200"
                    [style.background]="highlightAll ? 'rgba(252,211,77,0.15)' : 'transparent'"
                  >
                    @if (highlightAll) {
                      <span style="color: #FCD34D; font-weight: bold;">  weight: number;</span>
                      <span style="color: #34D399; font-weight: bold;"> ‚Üê edit once ‚úÖ</span>
                    } @else {
                      <span style="color: #64748B;">  icon: string;</span>
                    }
                  </div>
                </div>
                <span style="color: #94A3B8;">&#125;</span>
              </div>
            </div>

            <!-- Specific Interfaces -->
            <div class="pl-4 space-y-2 relative">
              <div class="absolute left-0 top-2 bottom-2 w-px rounded" style="background: var(--border-hi);"></div>
              @for (iface of goodInterfaces; track iface.name) {
                <div class="rounded-xl p-3 relative" style="background: rgba(59,130,246,0.06); border: 1px solid rgba(59,130,246,0.2);">
                  <div class="absolute -left-4 top-1/2 -translate-y-1/2 h-px w-4" style="background: var(--border-hi);"></div>
                  <div class="text-xs" style="font-family: 'JetBrains Mono', monospace;">
                    <span style="color: #C084FC;">interface </span>
                    <span style="color: #60A5FA; font-weight: bold;">{{ iface.name }}</span>
                    <span style="color: #64748B;"> extends Vehicle</span>
                    <span style="color: #94A3B8;"> &#123; {{ iface.extra }}; &#125;</span>
                  </div>
                </div>
              }
            </div>
          </div>
        </div>

      </div>

      <!-- Field Simulator -->
      <div class="rounded-2xl p-6 mb-10" style="background: #060B14; border: 1px solid var(--border);">
        <div class="flex items-center gap-2 mb-1">
          <span class="text-base">üî¨</span>
          <h3 class="font-bold" style="color: #E2E8F0;">Field Addition Simulator</h3>
        </div>
        <p class="text-sm mb-5" style="color: #64748B;">
          Click below to simulate adding
          <code class="px-1.5 py-0.5 rounded text-xs" style="background: rgba(245,158,11,0.15); color: #FCD34D; font-family: 'JetBrains Mono', monospace;">weight: number</code>
          to all vehicle types and see the cost difference:
        </p>
        @if (!highlightAll) {
          <button
            (click)="simulateAddField()"
            class="font-semibold py-2.5 px-6 rounded-xl text-sm transition-all duration-200 hover:opacity-90 active:scale-95"
            style="background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.3); color: #FCD34D;">
            ‚ûï Add field: weight: number
          </button>
        } @else {
          <div class="flex items-center gap-3 flex-wrap">
            <span class="font-semibold py-2 px-4 rounded-xl text-sm"
                  style="background: rgba(239,68,68,0.12); border: 1px solid rgba(239,68,68,0.25); color: #FCA5A5;">
              ‚ùå Overengineered: edited {{ interfaceCount }} interfaces
            </span>
            <span class="font-semibold py-2 px-4 rounded-xl text-sm"
                  style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.2); color: #6EE7B7;">
              ‚úÖ Good approach: edited 1 interface
            </span>
            <button
              (click)="resetSimulation()"
              class="text-sm transition-all duration-200 hover:opacity-80 underline"
              style="color: #64748B;">
              ‚Ü∫ Reset simulation
            </button>
          </div>
        }
      </div>

      <!-- Fleet Header -->
      <div class="flex items-center justify-between mb-5">
        <h2 class="text-xl font-bold" style="color: #F1F5F9;">Fleet</h2>
        <button
          (click)="dispatchAll()"
          class="font-semibold py-2.5 px-5 rounded-xl text-sm transition-all duration-200 hover:opacity-90 active:scale-95"
          style="background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.3); color: #FCD34D;">
          üöÄ Dispatch All
        </button>
      </div>

      <!-- Vehicle Cards -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        @for (card of vehicleCards; track card.vehicle.id) {
          <div
            class="rounded-2xl overflow-hidden transition-all duration-300"
            [style.background]="'var(--bg-surface)'"
            [style.border]="card.result ? '1px solid rgba(245,158,11,0.45)' : '1px solid var(--border)'"
          >
            <!-- Card Header -->
            <div class="p-5 pb-4" style="border-bottom: 1px solid var(--border);">
              <div class="text-4xl mb-3 select-none">{{ card.icon }}</div>
              <h3 class="font-bold text-base mb-2" style="color: #E2E8F0;">{{ card.vehicle.name }}</h3>
              <div class="flex gap-2 flex-wrap">
                <span class="text-xs px-2 py-1 rounded-lg" style="background: var(--bg-raised); border: 1px solid var(--border); color: #64748B; font-family: 'JetBrains Mono', monospace;">
                  {{ card.vehicle.color }}
                </span>
                <span class="text-xs px-2 py-1 rounded-lg" style="background: var(--bg-raised); border: 1px solid var(--border); color: #64748B; font-family: 'JetBrains Mono', monospace;">
                  {{ card.vehicle.maxSpeed }} km/h
                </span>
                <span class="text-xs px-2 py-1 rounded-lg" style="background: var(--bg-raised); border: 1px solid var(--border); color: #64748B; font-family: 'JetBrains Mono', monospace;">
                  {{ card.vehicle.payload }} kg
                </span>
              </div>
            </div>

            <!-- Card Body -->
            <div class="p-5">
              <div
                class="min-h-14 mb-4 text-sm rounded-xl p-3.5 transition-all duration-300"
                [style.background]="card.result ? 'rgba(245,158,11,0.07)' : 'var(--bg-raised)'"
                [style.border]="card.result ? '1px solid rgba(245,158,11,0.2)' : '1px solid var(--border)'"
              >
                @if (card.result) {
                  <p class="font-medium" style="color: #FCD34D;">üöÄ {{ card.result }}</p>
                } @else {
                  <p class="italic text-xs" style="color: #3D4F6E;">Press Dispatch</p>
                }
              </div>
              <button
                (click)="dispatch(card)"
                class="w-full font-semibold py-2.5 px-4 rounded-xl text-sm transition-all duration-200 hover:opacity-90 active:scale-95"
                style="background: rgba(245,158,11,0.12); border: 1px solid rgba(245,158,11,0.25); color: #FCD34D;">
                üöÄ Dispatch
              </button>
            </div>
          </div>
        }
      </div>

    </div>

    <!-- Right column: discussion sidebar -->
    <app-discussion-sidebar
      routeKey="overengineered"
      [questions]="[
        'Why can\'t the scooter safely substitute the base class?',
        'What design assumption was flawed from the beginning?',
        'How does this affect scalability?',
        'What are the typical organizational gaps that lead to this?'
      ]"
    ></app-discussion-sidebar>

  </div>
</div>
